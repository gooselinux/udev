From 5c5ebde711c4560ae0560e87c33fe477b5add354 Mon Sep 17 00:00:00 2001
From: Kay Sievers <kay.sievers@vrfy.org>
Date: Mon, 12 Apr 2010 01:12:23 +0200
Subject: [PATCH 07/10] cdrom_id: always set ID_CDROM regardless if we can run cdrom_id

---
 extras/cdrom_id/60-cdrom_id.rules |   12 +++++++++---
 1 files changed, 9 insertions(+), 3 deletions(-)

diff --git a/extras/cdrom_id/60-cdrom_id.rules b/extras/cdrom_id/60-cdrom_id.rules
index 132a680..811c4aa 100644
--- a/extras/cdrom_id/60-cdrom_id.rules
+++ b/extras/cdrom_id/60-cdrom_id.rules
@@ -1,5 +1,11 @@
 # do not edit this file, it will be overwritten on update
 
-# import optical drive properties
-ACTION=="add|change", SUBSYSTEM=="block", ENV{DEVTYPE}=="disk", \
-  KERNEL=="sr[0-9]*|xvd*", IMPORT{program}="cdrom_id --export $tempnode"
+ACTION!="add|change", GOTO="cdrom_end"
+SUBSYSTEM!="block", GOTO="cdrom_end"
+KERNEL!="sr[0-9]*|xvd*", GOTO="cdrom_end"
+ENV{DEVTYPE}!="disk", GOTO="cdrom_end"
+
+ENV{ID_CDROM}="1"
+IMPORT{program}="cdrom_id --export $tempnode"
+
+LABEL="cdrom_end"
-- 
1.7.0.1

